Savagely copy pasted & hacked from https://archive.codeplex.com/?p=color